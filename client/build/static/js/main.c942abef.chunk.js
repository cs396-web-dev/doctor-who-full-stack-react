(this["webpackJsonpdoctor-who-react"]=this["webpackJsonpdoctor-who-react"]||[]).push([[0],{16:function(e,t,n){"use strict";n.r(t);var o=n(1),s=n.n(o),r=n(9),a=n.n(r),c=n(3),i=n(4),l=n(2),d=n(6),h=n(5),u=n(0),j=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).resetData=o.resetData.bind(Object(l.a)(o)),o}return Object(i.a)(n,[{key:"resetData",value:function(e){fetch("/reset/").then((function(e){return e.json()})).then(this.props.onReset),e.preventDefault()}},{key:"render",value:function(){return Object(u.jsxs)("header",{className:"header",children:[Object(u.jsx)("h1",{children:this.props.title}),Object(u.jsx)("button",{id:"reset",className:"btn",onClick:this.resetData,children:"Reset Data"})]})}}]),n}(s.a.Component),b=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).handleSelection=o.handleSelection.bind(Object(l.a)(o)),o}return Object(i.a)(n,[{key:"handleSelection",value:function(e){var t=e.target.dataset.key,n=this.props.doctors.filter((function(e){return e._id===t}))[0];this.props.onDoctorSelection(n)}},{key:"render",value:function(){var e=this;return this.props.doctors?Object(u.jsxs)("aside",{className:"aside",children:[Object(u.jsx)("ol",{children:this.props.doctors.map((function(t){return Object(u.jsx)("li",{children:Object(u.jsx)("a",{href:"#","data-key":t._id,onClick:e.handleSelection,children:t.name})},t._id)}))}),Object(u.jsx)("button",{className:"btn",onClick:this.props.addNewDoc,children:"Add New"})]}):Object(u.jsx)("aside",{className:"aside"})}}]),n}(s.a.Component),m=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).deleteDoc=o.deleteDoc.bind(Object(l.a)(o)),o}return Object(i.a)(n,[{key:"deleteDoc",value:function(e){var t=this;if(window.confirm("Are you sure?")){var n="/doctors/".concat(this.props.doctor._id);fetch(n,{method:"DELETE"}).then((function(e){return e.text()})).then((function(){t.props.onDoctorDelete()}))}}},{key:"render",value:function(){var e=this,t=this.props.doctor;return t.name?Object(u.jsxs)("div",{className:"doctor",children:[Object(u.jsxs)("div",{className:"top",children:[Object(u.jsx)("h2",{children:t.name}),Object(u.jsxs)("div",{children:[Object(u.jsx)("button",{className:"btn",onClick:function(t){e.props.onToggleMode("edit",t)},children:"Edit"}),Object(u.jsx)("button",{className:"btn",onClick:this.deleteDoc,children:"delete"})]})]}),t.image_url&&Object(u.jsx)("img",{alt:t.name+" image",className:"thumbMedium",src:t.image_url}),Object(u.jsxs)("p",{children:["Seasons: ",t.seasons?t.seasons.join(", "):""]})]}):Object(u.jsx)("section",{className:"doctor"})}}]),n}(s.a.Component),p=n(8),O=n(10),f=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var o;Object(c.a)(this,n),o=t.call(this,e);var s=e.doctor,r=s._id,a=s.name,i=s.seasons,d=s.ordering,h=s.image_url;return o.state={_id:r,name:a,seasons:i?i.join(", "):"",ordering:d,image_url:h,errors:{name:"",seasons:"",ordering:"",image_url:""}},o.handleChange=o.handleChange.bind(Object(l.a)(o)),o.handleSubmit=o.handleSubmit.bind(Object(l.a)(o)),o}return Object(i.a)(n,[{key:"handleChange",value:function(e){var t,n=e.currentTarget.value,o=e.currentTarget.name,s=this.state.errors;if("name"===o)s[o]=n.length>=1?"":"Name is required";else if("seasons"===o){var r,a="",c=n.split(","),i=Object(O.a)(c);try{for(i.s();!(r=i.n()).done;){var l=r.value,d=parseInt(l.trim());if(Number.isNaN(d)&&l.trim().length>0){a='Please verify that your "seasons" entry is correct.';break}}}catch(j){i.e(j)}finally{i.f()}s[o]=a}else if("ordering"===o){var h="",u=parseInt(n.trim());Number.isNaN(u)&&n.trim().length>0&&(h="Ordering must be an integer."),s[o]=h,0===s[o].length&&(n=parseInt(n))}this.setState((t={},Object(p.a)(t,o,n),Object(p.a)(t,"errors",s),t))}},{key:"parseSeasons",value:function(e){return e.toString().split(",").map((function(e){return parseInt(e.trim())})).filter((function(e){return!Number.isNaN(e)}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=this.state.errors;if(!(n.name.length>0||n.seasons.length>0|n.ordering.length>0)){var o={name:this.state.name,seasons:this.parseSeasons(this.state.seasons),ordering:this.state.ordering,image_url:this.state.image_url},s="/doctors/",r="POST";"edit"===this.props.mode&&(s+=this.state._id,r="PATCH"),fetch(s,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(e){t.props.onDoctorCreateUpdate(e),t.props.onToggleMode("view")}))}}},{key:"render",value:function(){var e=this,t=this.state._id?"Update":"Create",n=this.state.errors;return this.state._id||"create"===this.props.mode?Object(u.jsx)("div",{className:"doctor",children:Object(u.jsxs)("form",{id:"edit-doctor-form",children:[Object(u.jsx)("div",{className:"error"}),Object(u.jsxs)("div",{className:"input-section",children:[Object(u.jsx)("label",{children:"Name"}),Object(u.jsx)("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleChange}),n.name.length>0&&Object(u.jsx)("span",{className:"error",children:n.name})]}),Object(u.jsxs)("div",{className:"input-section",children:[Object(u.jsx)("label",{children:"Seasons"}),Object(u.jsx)("input",{type:"text",name:"seasons",value:this.state.seasons,onChange:this.handleChange}),n.seasons.length>0&&Object(u.jsx)("span",{className:"error",children:n.seasons})]}),Object(u.jsxs)("div",{className:"input-section",children:[Object(u.jsx)("label",{children:"Ordering"}),Object(u.jsx)("input",{type:"text",name:"ordering",value:this.state.ordering,onChange:this.handleChange}),n.ordering.length>0&&Object(u.jsx)("span",{className:"error",children:n.ordering})]}),Object(u.jsxs)("div",{className:"input-section",children:[Object(u.jsx)("label",{children:"Image"}),Object(u.jsx)("input",{type:"text",name:"image_url",value:this.state.image_url,onChange:this.handleChange})]}),Object(u.jsx)("button",{className:"btn btn-main",onClick:this.handleSubmit,children:t}),Object(u.jsx)("a",{className:"btn",onClick:function(t){e.props.onToggleMode("view",t)},children:"Cancel"})]})}):Object(u.jsx)("section",{className:"doctor"})}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!e.doctor||e.doctor._id===t._id)return null;var n=e.doctor,o=n._id,s=n.name,r=n.seasons,a=n.ordering,c=n.image_url;return{_id:o,name:s,seasons:r?r.join(", "):"",ordering:a,image_url:c,errors:{name:"",seasons:"",ordering:"",image_url:""}}}}]),n}(s.a.Component),g=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){var e=this.props.doctor||{};return"view"===this.props.mode?Object(u.jsx)(m,{doctor:e,mode:this.props.mode,onToggleMode:this.props.onToggleMode,onDoctorDelete:this.props.onDoctorDelete}):Object(u.jsx)(f,{doctor:e,mode:this.props.mode,onToggleMode:this.props.onToggleMode,onDoctorCreateUpdate:this.props.onDoctorCreateUpdate})}}]),n}(s.a.Component),v=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){if(!this.props.companions)return Object(u.jsx)("section",{className:"companions"});var e=this.props.companions;return Object(u.jsxs)("section",{className:"companions",children:[Object(u.jsx)("h2",{children:"Companions"}),Object(u.jsx)("table",{children:Object(u.jsx)("tbody",{children:e.map((function(e){return Object(u.jsxs)("tr",{"data-id":e._id,children:[Object(u.jsx)("td",{children:Object(u.jsx)("img",{className:"thumb",alt:e.name+" image",src:e.image_url})}),Object(u.jsx)("td",{children:e.name})]},e._id)}))})})]})}}]),n}(s.a.Component),D=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return Object(u.jsx)(v,{companions:this.props.companions})}}]),n}(s.a.Component),x=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).modes={view:"view",edit:"edit",create:"create"},o.state={currentDoctor:null,currentCompanions:null,mode:o.modes.view},o.handleDoctorSelection=o.handleDoctorSelection.bind(Object(l.a)(o)),o.fetchDoctors=o.fetchDoctors.bind(Object(l.a)(o)),o.handleCreateUpdateDoctor=o.handleCreateUpdateDoctor.bind(Object(l.a)(o)),o.handleDeleteDoctor=o.handleDeleteDoctor.bind(Object(l.a)(o)),o.showCreateDocForm=o.showCreateDocForm.bind(Object(l.a)(o)),o.handleReset=o.handleReset.bind(Object(l.a)(o)),o.toggleMode=o.toggleMode.bind(Object(l.a)(o)),o}return Object(i.a)(n,[{key:"handleDoctorSelection",value:function(e){var t=this;this.setState({currentDoctor:e,mode:this.modes.view}),fetch("/doctors/".concat(e._id,"/companions")).then((function(e){return e.json()})).then((function(e){t.setState({currentCompanions:e})}))}},{key:"showCreateDocForm",value:function(){this.setState({currentDoctor:null,currentCompanions:null,mode:this.modes.create})}},{key:"componentDidMount",value:function(){this.fetchDoctors()}},{key:"fetchDoctors",value:function(){var e=this;fetch("/doctors").then((function(e){return e.json()})).then((function(t){e.setState({doctors:t})}))}},{key:"toggleMode",value:function(e,t){this.setState({mode:this.modes[e]}),t&&t.preventDefault()}},{key:"handleReset",value:function(){this.handleDeleteDoctor()}},{key:"handleCreateUpdateDoctor",value:function(e){this.setState({currentDoctor:e}),this.fetchDoctors()}},{key:"handleDeleteDoctor",value:function(){this.setState({currentDoctor:null,currentCompanions:null}),this.fetchDoctors()}},{key:"render",value:function(){return Object(u.jsxs)("div",{className:"container",children:[Object(u.jsx)(j,{title:"Doctor Who Editor",onReset:this.handleReset}),Object(u.jsx)(b,{onDoctorSelection:this.handleDoctorSelection,doctors:this.state.doctors,addNewDoc:this.showCreateDocForm}),Object(u.jsxs)("main",{className:"main",children:[Object(u.jsx)(g,{doctor:this.state.currentDoctor,mode:this.state.mode,onToggleMode:this.toggleMode,onDoctorCreateUpdate:this.handleCreateUpdateDoctor,onDoctorDelete:this.handleDeleteDoctor}),Object(u.jsx)(D,{companions:this.state.currentCompanions})]})]})}}]),n}(s.a.Component);a.a.render(Object(u.jsx)(x,{}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.c942abef.chunk.js.map